## clear variables in environment and script
rm(list=ls(all=TRUE)); cat("\014")
if(!require(pacman)) install.packages('pacman')
pacman::p_load( data.table,ggplot2, dplyr, gamlr, nnet, imputeTS, caret, scales, ggthemes, foreign, ggrepel, readr, tidyr, plm, broom, dplyr, Hmisc, sqldf, stargazer, stringr, zoo, glmnet, import, lubridate, ncdf4, raster, lfe, sjPlot, tigris, rgdal, GGally, dotwhisker,choroplethr, choroplethrMaps, splines, fixest, sf,ggpubr, car, geojsonsf, rgeos, rmapshaper, readxl, usmap)
if(Sys.info()["user"] == "annapapp") {
setwd('/Users/annapapp/Library/CloudStorage/GoogleDrive-ap3907@columbia.edu/My Drive/PhD/01_research/00_research/09_crypto/crypto_jpube') # anna WD
} else {
setwd('/[OTHER USER]')
}
# load 2022 annual emissions data for coal, gas, oil, and other plants
coal <- read.csv("data/annual_emissions/annual-emissions-2022-coal.csv")
coal <- coal %>% mutate(type = "1 coal")
gas <- read.csv("data/annual_emissions/annual-emissions-2022-gas.csv")
gas <- gas %>% mutate(type = "3 gas")
oil <- read.csv("data/annual_emissions/annual-emissions-2022-oil.csv")
oil <- oil %>% mutate(type = "2 oil")
other <- read.csv("data/annual_emissions/annual-emissions-2022-other.csv")
other <- other %>% mutate(type = "4 other")
data <- rbind(coal, gas, oil, other)
rm(coal, gas, oil, other)
coalType <- read.csv("data/other/coal-type.csv")
data <- left_join(data, coalType)
# Now Create Plots ---------------------------------------------------------------------------
data <- read.csv("output/03_context_extvalidity/plant_distribution.csv")
colors <- c("Coal" = "#882255", "Oil" = "#44AA99", "Gas" = "#DDCC77")
a <- ggplot(data, aes(x=heatRate, fill=type)) +
geom_histogram( bins = 100, position = "stack") +
scale_fill_manual(values = colors, name = "Fuel Type")+
geom_vline(xintercept = 14436.49, linetype = "dashed") +
geom_vline(xintercept = 15281.21, linetype = "dashed", color="red") +
geom_vline(xintercept = 10709.49, linetype = "dashed", color="blue") +
xlim(0, 40000)+
xlab("Heat Rate (Btu / kWh)") + ylab("Count") +
theme_bw() +
theme(legend.position = "bottom",
axis.text.x=element_text(size = 14),
axis.text.y=element_text(size = 16),
axis.title.x=element_text(size = 14),
axis.title.y=element_text(size = 16),
legend.text=element_text(size=12),
legend.title=element_text(size=16))
b <- ggplot(data, aes(x=co2Rate, fill=type)) +
geom_histogram( bins = 100, position = "stack") +
scale_fill_manual(values = colors, name="Fuel Type")+
geom_vline(xintercept = 1.372427, linetype = "dashed") +
geom_vline(xintercept = 1.114522, linetype = "dashed", color="blue") +
geom_vline(xintercept = 0.48, linetype = "solid", color="#117733", size = 1) +
xlab("Carbon Intensity (kg CO2 per kWh)") + ylab(" ") +
theme_bw() +
xlim(0, 2)+
theme(legend.position = "bottom",
axis.text.x=element_text(size = 14),
axis.text.y=element_text(size = 16),
axis.title.x=element_text(size = 14),
axis.title.y=element_text(size = 16),
legend.text=element_text(size=12),
legend.title=element_text(size=16))
# FIGURE 4
ggarrange(a, b, ncol=2, nrow=1, common.legend = TRUE, legend="bottom") +  bgcolor("white") + border("white") + labs(color="Fuel")
